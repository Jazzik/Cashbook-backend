# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Thread ID –¥–ª—è Telegram –±–æ—Ç–∞

## –û–±–∑–æ—Ä

–î–æ–±–∞–≤–ª–µ–Ω–∞ –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–π thread –≤ Telegram —á–∞—Ç–µ. –ï—Å–ª–∏ `TELEGRAM_THREAD_ID` –Ω–µ –∑–∞–¥–∞–Ω, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç.

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞

### 1. –ü–æ–ª—É—á–µ–Ω–∏–µ Thread ID

–î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è thread ID –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—É—é —Ñ—É–Ω–∫—Ü–∏—é:

```bash
cd telegram-bot
node -e "require('./bot').startMessageListener()"
```

–û—Ç–ø—Ä–∞–≤—å—Ç–µ –ª—é–±–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –Ω—É–∂–Ω—ã–π thread, –∏ –≤ –∫–æ–Ω—Å–æ–ª–∏ –ø–æ—è–≤–∏—Ç—Å—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è —Å thread ID.

### 2. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ –≤–∞—à `.env` —Ñ–∞–π–ª:

```env
TELEGRAM_BOT_TOKEN=your_bot_token_here
TELEGRAM_CHAT_ID=your_chat_id_here
TELEGRAM_THREAD_ID=your_thread_id_here  # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ
```

### 3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Jenkins

–í Jenkins –º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å credentials –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞ (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ):

- `{shop}-telegram-thread-id` - Thread ID –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞

–ù–∞–ø—Ä–∏–º–µ—Ä:

- `makarov-telegram-thread-id`
- `yuz1-telegram-thread-id`
- `testing-telegram-thread-id`

**–í–∞–∂–Ω–æ**: –ï—Å–ª–∏ credential –¥–ª—è thread ID –Ω–µ —Å–æ–∑–¥–∞–Ω –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –º–∞–≥–∞–∑–∏–Ω–∞, –±–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±—É–¥–µ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç –±–µ–∑ –æ—à–∏–±–æ–∫.

## –ü–æ–≤–µ–¥–µ–Ω–∏–µ

- **–° thread ID**: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ —É–∫–∞–∑–∞–Ω–Ω—ã–π thread
- **–ë–µ–∑ thread ID**: –ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è –æ—Ç–ø—Ä–∞–≤–ª—è—é—Ç—Å—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
- **–û—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–π credential –≤ Jenkins**: Pipeline –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç —Ä–∞–±–æ—Ç—É, –±–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç
- **–û—à–∏–±–∫–∞ thread ID**: –ë–æ—Ç –ø–æ–ø—ã—Ç–∞–µ—Ç—Å—è –æ—Ç–ø—Ä–∞–≤–∏—Ç—å –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç

## –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫

### –í Jenkins Pipeline

–ï—Å–ª–∏ credential `{shop}-telegram-thread-id` –Ω–µ —Å—É—â–µ—Å—Ç–≤—É–µ—Ç:

1. Pipeline –≤—ã–≤–æ–¥–∏—Ç —Å–æ–æ–±—â–µ–Ω–∏–µ: `"Thread ID credential not found for {shop}, using main chat"`
2. –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `TELEGRAM_THREAD_ID` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –≤ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É
3. –î–µ–ø–ª–æ–π –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
4. –ë–æ—Ç –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —Å–æ–æ–±—â–µ–Ω–∏—è –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç

## –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

–ë–æ—Ç –≤—ã–≤–æ–¥–∏—Ç –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ —Ç–æ–º, –∫—É–¥–∞ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç—Å—è —Å–æ–æ–±—â–µ–Ω–∏–µ:

```
üßµ Thread ID: 12345
–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ thread ID: 12345
```

–∏–ª–∏

```
üßµ Thread ID: –Ω–µ –∑–∞–¥–∞–Ω (–æ—Ç–ø—Ä–∞–≤–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç)
–û—Ç–ø—Ä–∞–≤–∫–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–π —á–∞—Ç (–±–µ–∑ thread ID)
```
